<div class="chatbot-container" [class.open]="isOpen()">
  <!-- BotÃ³n flotante -->
  <button class="chatbot-toggle" (click)="toggleChat()" [class.open]="isOpen()">
    <i class="chat-icon" [class.close]="isOpen()">ðŸ’¬</i>
    <i class="close-icon" [class.open]="isOpen()">âœ•</i>
  </button>

  <!-- Ventana del chat -->
  <div class="chatbot-window" [class.open]="isOpen()">
    <!-- Header -->
    <div class="chatbot-header">
      <div class="bot-info">
        <div class="bot-avatar">ðŸ¤–</div>
        <div class="bot-details">
          <h4>Asistente ElDato</h4>
          <span class="status">En lÃ­nea</span>
        </div>
      </div>
      <button class="minimize-btn" (click)="toggleChat()">âˆ’</button>
    </div>

    <!-- Mensajes -->
    <div class="chatbot-messages" #messagesContainer>
      @for (message of messages(); track message.timestamp) {
        <div [class]="'message ' + (message.isBot ? 'bot-message' : 'user-message')">
          @if (message.isBot) {
            <div class="message-avatar">ðŸ¤–</div>
          }
          <div class="message-content">
            <p>{{ message.text }}</p>
            <span class="message-time">{{ formatTime(message.timestamp) }}</span>
          </div>
          @if (!message.isBot) {
            <div class="message-avatar user-avatar">ðŸ‘¤</div>
          }
        </div>
      }
      
      <!-- Indicador de escritura -->
      @if (isTyping()) {
        <div class="typing-indicator">
          <div class="message bot-message">
            <div class="message-avatar">ðŸ¤–</div>
            <div class="message-content">
              <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        </div>
      }
    </div>

    <!-- Input -->
    <div class="chatbot-input">
      <div class="input-container">
        <input type="text" 
               [(ngModel)]="currentMessage" 
               (keyup.enter)="sendMessage()"
               placeholder="Escribe tu mensaje..."
               class="message-input"
               [disabled]="isTyping()">
        <button class="send-btn" 
                (click)="sendMessage()" 
                [disabled]="!currentMessage.trim() || isTyping()">
          ðŸ“¤
        </button>
      </div>
    </div>
  </div>
</div>