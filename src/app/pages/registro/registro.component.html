<div class="login-layout">
  
  <!-- Lado Izquierdo: Branding -->
  <div class="branding-side">
    <div class="branding-overlay"></div>
    <div class="branding-content">
      <div class="brand-logo-text">El Dato</div>
      <h1>Donde el Talento <br> <span class="text-highlight">Encuentra Oportunidades</span></h1>
      <p class="branding-description">
        √önete a la comunidad de servicios m√°s confiable. Conecta con expertos verificados o haz crecer tu negocio con herramientas profesionales dise√±adas para ti.
      </p>

      <div class="marketing-features">
        <div class="feature-item">
          <div class="feature-icon-wrapper">
            <i class="fas fa-rocket"></i>
          </div>
          <div class="feature-text">
            <h3>R√°pido y Eficiente</h3>
            <p>Publica o contrata servicios en minutos.</p>
          </div>
        </div>

        <div class="feature-item">
          <div class="feature-icon-wrapper">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="feature-text">
            <h3>Confianza Total</h3>
            <p>Rese√±as reales y perfiles verificados.</p>
          </div>
        </div>

        <div class="feature-item">
          <div class="feature-icon-wrapper">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="feature-text">
            <h3>Impulsa tu √âxito</h3>
            <p>Gestiona tu agenda y clientes f√°cilmente.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lado Derecho: Formulario -->
  <div class="form-side">
    <div class="form-container">
      
      <div class="header-section">
        <h2>Crear Cuenta</h2>
        <p class="subtitle">Completa tus datos para comenzar</p>
      </div>

      <form class="login-form" [formGroup]="form" (ngSubmit)="onSubmit()">
        
        <!-- Nombre -->
        <div class="form-group">
          <label class="form-label">Nombre Completo *</label>
          <div class="input-wrapper">
            <i class="fas fa-user input-icon"></i>
            <input type="text" class="form-input" placeholder="Ej: Juan P√©rez"
                   formControlName="nombre" [class.invalid]="invalid('nombre')" required>
          </div>
          <div class="error-text" *ngIf="invalid('nombre')">
            <span *ngIf="form.get('nombre')?.errors?.['required']">El nombre es obligatorio.</span>
            <span *ngIf="form.get('nombre')?.errors?.['incompleteName']">Ingresa tu nombre y apellido.</span>
          </div>
        </div>

        <!-- Fecha de nacimiento -->
        <div class="form-group">
          <label class="form-label">Fecha de nacimiento *</label>
          <div class="input-wrapper">
            <i class="fas fa-birthday-cake input-icon"></i>
            <input type="date" class="form-input"
                   formControlName="fechaNacimiento" 
                   [attr.max]="maxDateAllowed"
                   [class.invalid]="invalid('fechaNacimiento')" required>
          </div>
          <div class="error-text" *ngIf="invalid('fechaNacimiento')">
            <span *ngIf="form.get('fechaNacimiento')?.errors?.['required']">La fecha es obligatoria.</span>
            <span *ngIf="form.get('fechaNacimiento')?.errors?.['underAge']">Debes ser mayor de 18 a√±os.</span>
          </div>
        </div>

        <!-- Direcci√≥n -->
        <div class="form-group" style="position: relative;">
          <label class="form-label">Direcci√≥n *</label>
          <div class="input-wrapper">
            <i class="fas fa-map-marker-alt input-icon"></i>
            <input #direccionInput type="text" class="form-input" placeholder="Busca tu direcci√≥n..."
                   autocomplete="off"
                   (keydown.enter)="$event.preventDefault()"
                   (input)="onDireccionInput(direccionInput.value)"
                   (focus)="abrirSugerenciasSiHay()"
                   (blur)="onDireccionBlur()"
                   [value]="form.value.direccionDescripcion || ''"
                   [class.invalid]="invalid('direccionDescripcion')" required>
          </div>
          <div class="error-text" *ngIf="invalid('direccionDescripcion')">La direcci√≥n es obligatoria.</div>

          <!-- Sugerencias OSM -->
          <ul class="sugerencias" *ngIf="mostrandoSugerencias">
            <li class="sugerencia-item" *ngFor="let s of sugerencias"
                (mousedown)="seleccionarSugerencia(s, direccionInput)">
              {{ s.display_name }}
            </li>
          </ul>
        </div>

        <!-- Correo -->
        <div class="form-group">
          <label class="form-label">Correo electr√≥nico *</label>
          <div class="input-wrapper">
            <i class="fas fa-envelope input-icon"></i>
            <input type="email" class="form-input" placeholder="ejemplo@correo.com"
                   formControlName="correo" [class.invalid]="invalid('correo')" required>
          </div>
          <div class="error-text" *ngIf="invalid('correo')">Ingresa un correo v√°lido.</div>
        </div>

        <!-- Tel√©fono -->
        <div class="form-group">
          <label class="form-label">Tel√©fono *</label>
          <div class="input-wrapper">
            <i class="fas fa-phone input-icon"></i>
            <input type="tel" class="form-input" placeholder="Ej: 912345678"
                   formControlName="telefono" [class.invalid]="invalid('telefono')" required>
          </div>
          <div class="error-text" *ngIf="invalid('telefono')">
            <span *ngIf="form.get('telefono')?.errors?.['required']">El tel√©fono es obligatorio.</span>
            <span *ngIf="form.get('telefono')?.errors?.['pattern']">Solo se permiten n√∫meros.</span>
            <span *ngIf="form.get('telefono')?.errors?.['minlength']">M√≠nimo 8 d√≠gitos.</span>
          </div>
        </div>

        <!-- Contrase√±as -->
        <div formGroupName="passwordGroup">
          <div class="form-group">
            <label class="form-label">Contrase√±a *</label>
            <div class="input-wrapper">
              <i class="fas fa-lock input-icon"></i>
              <input [type]="showPass ? 'text' : 'password'" class="form-input"
                     placeholder="M√≠nimo 6 caracteres" formControlName="password"
                     [class.invalid]="form.get('passwordGroup.password')?.invalid && (form.get('passwordGroup.password')?.touched || form.get('passwordGroup.password')?.dirty)" required>
              <button type="button" class="toggle-password" (click)="togglePassword()">
                <i class="fas" [ngClass]="showPass ? 'fa-eye-slash' : 'fa-eye'"></i>
              </button>
            </div>
            <div class="error-text" *ngIf="form.get('passwordGroup.password')?.invalid && (form.get('passwordGroup.password')?.touched || form.get('passwordGroup.password')?.dirty)">
              La contrase√±a es obligatoria (m√≠nimo 6 caracteres).
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Repetir contrase√±a *</label>
            <div class="input-wrapper">
              <i class="fas fa-lock input-icon"></i>
              <input [type]="showPass2 ? 'text' : 'password'" class="form-input"
                     placeholder="Repite tu contrase√±a" formControlName="repeatPassword"
                     [class.invalid]="(form.get('passwordGroup.repeatPassword')?.touched || form.get('passwordGroup.repeatPassword')?.dirty) && !passwordsMatch" required>
              <button type="button" class="toggle-password" (click)="togglePassword2()">
                <i class="fas" [ngClass]="showPass2 ? 'fa-eye-slash' : 'fa-eye'"></i>
              </button>
            </div>
            <div class="error-text" *ngIf="form.get('passwordGroup')?.touched && form.get('passwordGroup')?.errors?.['passwordsMismatch']">
              Las contrase√±as no coinciden.
            </div>
          </div>
        </div>

        <!-- Tipo de Usuario (Selector Visual) -->
        <div class="form-group">
          <label class="form-label">¬øC√≥mo quieres usar la plataforma? *</label>
          <div class="user-type-selector">
            
            <label class="type-card" [class.selected]="form.get('tipoUsuario')?.value === 'solicitante'">
              <input type="radio" formControlName="tipoUsuario" value="solicitante" class="hidden-radio">
              <div class="card-content">
                <span class="card-icon">üîç</span>
                <span class="card-title">Solicitante</span>
                <span class="card-desc">Busco servicios</span>
              </div>
            </label>

            <label class="type-card" [class.selected]="form.get('tipoUsuario')?.value === 'proveedor'">
              <input type="radio" formControlName="tipoUsuario" value="proveedor" class="hidden-radio">
              <div class="card-content">
                <span class="card-icon">üõ†Ô∏è</span>
                <span class="card-title">Proveedor</span>
                <span class="card-desc">Ofrezco servicios</span>
              </div>
            </label>

          </div>
        </div>

        <!-- Botones -->
        <div class="actions-group">
          <button type="submit" class="btn-primary" [disabled]="form.invalid">
            Registrarme
          </button>
          
          <button type="button" class="btn-secondary" (click)="routeLogin()">
            Ya tengo cuenta, Iniciar Sesi√≥n
          </button>
        </div>

      </form>
    </div>
  </div>
</div>
